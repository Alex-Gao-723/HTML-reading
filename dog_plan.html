<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŒå® æ‰“èµå°ç¨‹åº - äº§å“æ–¹æ¡ˆæ–‡æ¡£</title>
    <!-- å¼•å…¥ Mermaid ç»˜å›¾åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body { font-family: 'å¾®è½¯é›…é»‘', sans-serif; background-color: #f4f6f8; color: #333; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: #fff; padding: 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-radius: 8px; }
        h1 { text-align: center; color: #1677ff; border-bottom: 2px solid #eee; padding-bottom: 20px; }
        h2 { border-left: 5px solid #1677ff; padding-left: 10px; margin-top: 40px; background: #f0f7ff; padding: 10px; }
        .diagram-box { text-align: center; margin: 20px 0; overflow-x: auto; }
        
        /* æ¨¡æ‹Ÿæ‰‹æœºç•Œé¢çš„æ ·å¼ */
        .phone-mockup {
            width: 300px;
            height: 600px;
            border: 10px solid #333;
            border-radius: 30px;
            margin: 0 auto;
            background: #fff;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .phone-header { background: #1677ff; color: #fff; padding: 15px; text-align: center; font-size: 14px; }
        .phone-content { padding: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .dog-card { 
            height: 120px; 
            background: #eee; 
            border-radius: 8px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            border: 2px solid transparent;
            position: relative;
        }
        .dog-card:hover { border-color: #1677ff; background: #e6f7ff; }
        .dog-card::after { content: 'ğŸ¶'; font-size: 40px; }
        .selected { border-color: #1677ff; background: #e6f7ff; }
        .selected::before { content: 'âœ”'; position: absolute; top: 5px; right: 5px; color: #1677ff; font-weight: bold;}
        
        .pay-btn {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: 80%; background: #1677ff; color: #fff; text-align: center;
            padding: 12px; border-radius: 25px; cursor: pointer; font-weight: bold;
            box-shadow: 0 4px 10px rgba(22, 119, 255, 0.3);
        }
        .pay-btn:active { background: #0958d9; }
        
        .note { font-size: 12px; color: #666; text-align: center; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ¶ èŒå® æ‰“èµå°ç¨‹åº - äº§å“äº¤äº’æ–¹æ¡ˆ</h1>

    <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šä¸šåŠ¡æµç¨‹å›¾ -->
    <h2>1. ä¸šåŠ¡é€»è¾‘æµç¨‹å›¾ (Flowchart)</h2>
    <p>è¿™æ˜¯ç»™åç«¯å’Œå‰ç«¯å¼€å‘äººå‘˜çœ‹çš„ï¼Œæè¿°äº†æ•°æ®æ˜¯æ€ä¹ˆæµè½¬çš„ã€‚</p>
    <div class="diagram-box">
        <pre class="mermaid">
        graph TD
            Start((ç”¨æˆ·æ‰“å¼€å°ç¨‹åº)) --> API[è°ƒç”¨æ¥å£: è·å–å›¾ç‰‡]
            API --> Server{Javaåç«¯å¤„ç†}
            Server -->|éšæœºç”Ÿæˆ| Data[è¿”å›4å¼ å›¾ç‰‡URL]
            Data --> Render[å‰ç«¯æ¸²æŸ“: 2x2ç½‘æ ¼å±•ç¤º]
            
            Render --> UserAct[ç”¨æˆ·ç‚¹å‡»æŸå¼ å›¾ç‰‡]
            UserAct --> Select[UIäº¤äº’: å›¾ç‰‡é«˜äº®é€‰ä¸­]
            Select --> BtnClick[ç‚¹å‡»'æ‰“èµ1å…ƒ'æŒ‰é’®]
            
            BtnClick --> PayAPI[è°ƒç”¨æ”¯ä»˜å®æ”¯ä»˜æ¥å£]
            PayAPI --> AliPay{æ”¯ä»˜ç»“æœ?}
            
            AliPay -->|æˆåŠŸ| Success[åç«¯: è®°å½•è®¢å•çŠ¶æ€]
            Success --> Toast[å‰ç«¯å¼¹çª—: è°¢è°¢è€æ¿çš„ç‹—ç²®!]
            Toast --> Refresh[åˆ·æ–°é¡µé¢/æ›´æ¢å›¾ç‰‡]
            
            AliPay -->|å¤±è´¥/å–æ¶ˆ| Fail[å‰ç«¯æç¤º: æ”¯ä»˜æœªå®Œæˆ]
            Fail --> Stay[åœç•™åœ¨å½“å‰é¡µ]
        </pre>
    </div>

    <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šæ—¶åºå›¾ -->
    <h2>2. ç³»ç»Ÿäº¤äº’æ—¶åºå›¾ (Sequence Diagram)</h2>
    <p>è¿™å±•ç¤ºäº†ç”¨æˆ·ã€å°ç¨‹åºã€ä½ çš„æœåŠ¡å™¨ã€æ”¯ä»˜å®æœåŠ¡å™¨å››è€…ä¹‹é—´çš„å¯¹è¯ã€‚</p>
    <div class="diagram-box">
        <pre class="mermaid">
        sequenceDiagram
            participant User as ğŸ™‹â€â™‚ï¸ ç”¨æˆ·
            participant Mini as ğŸ“± å°ç¨‹åºå‰ç«¯
            participant Java as ğŸ–¥ï¸ ä½ çš„JavaæœåŠ¡å™¨
            participant Ali as ğŸ’° æ”¯ä»˜å®å®˜æ–¹
            
            User->>Mini: æ‰“å¼€é¦–é¡µ
            Mini->>Java: GET /api/dogs (è·å–å›¾ç‰‡)
            Java-->>Mini: è¿”å›å›¾ç‰‡åˆ—è¡¨ JSON
            Mini-->>User: å±•ç¤º4åªå°ç‹—
            
            User->>Mini: é€‰ä¸­ä¸€åª -> ç‚¹å‡»æ‰“èµ
            Mini->>Java: POST /api/pay/create (åˆ›å»ºè®¢å•)
            Java->>Ali: è¯·æ±‚é¢„ä¸‹å•
            Ali-->>Java: è¿”å› tradeNO (äº¤æ˜“å·)
            Java-->>Mini: è¿”å›æ”¯ä»˜å‚æ•°
            
            Mini->>Ali: å”¤èµ·æ”¶é“¶å° (my.tradePay)
            User->>Ali: è¾“å…¥å¯†ç /æŒ‡çº¹
            Ali-->>Mini: æ”¯ä»˜æˆåŠŸå›è°ƒ
            
            Mini-->>User: âœ… å¼¹çª—: è°¢è°¢ç‹—ç²®!
            Mini->>Java: (åå°å¼‚æ­¥) æŸ¥è¯¢ç¡®è®¤è®¢å•çŠ¶æ€
        </pre>
    </div>

    <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šUIåŸå‹å›¾ -->
    <h2>3. ç•Œé¢äº¤äº’åŸå‹ (UI Wireframe)</h2>
    <p>è¿™æ˜¯ç»™å‰ç«¯çœ‹çš„ï¼Œé¡µé¢å¤§æ¦‚é•¿ä»€ä¹ˆæ ·ï¼ˆä½ å¯ä»¥è¯•ç€ç‚¹å‡»ä¸‹é¢çš„æ–¹å—ï¼‰ã€‚</p>
    
    <div class="phone-mockup">
        <div class="phone-header">èŒå® æ‰“èµä¸­å¿ƒ</div>
        <div class="phone-content">
            <div class="dog-card" onclick="selectDog(this)"></div>
            <div class="dog-card" onclick="selectDog(this)"></div>
            <div class="dog-card" onclick="selectDog(this)"></div>
            <div class="dog-card" onclick="selectDog(this)"></div>
        </div>
        <div class="note">ğŸ‘† ç‚¹å‡»ä¸Šæ–¹æ–¹å—æ¨¡æ‹Ÿé€‰ä¸­</div>
        <div class="pay-btn" onclick="alert('è°ƒç”¨æ”¯ä»˜å®æ¥å£ï¼šæ”¯ä»˜ 1.00 å…ƒ')">ğŸ’° æ‰“èµ 1 å…ƒ</div>
    </div>

</div>

<script>
    // åˆå§‹åŒ– Mermaid
    mermaid.initialize({startOnLoad:true});

    // ç®€å•çš„äº¤äº’è„šæœ¬ï¼Œä¸ºäº†æ¼”ç¤ºåŸå‹æ•ˆæœ
    function selectDog(element) {
        // æ¸…é™¤å…¶ä»–é€‰ä¸­çŠ¶æ€
        document.querySelectorAll('.dog-card').forEach(el => el.classList.remove('selected'));
        // é€‰ä¸­å½“å‰
        element.classList.add('selected');
    }
</script>

</body>
</html>